{% from 'table/links.html' import format_pichash, format_function_id %}
{% from 'table/pagination_widget.html' import pagination_widget %}
{% extends 'base.html' %}
{% block title%}
Unique Blocks for Family: {{ family_id }}
{% endblock %}

{% block style %}
{% endblock %}

{% block content %}

<h1 id="unique-blocks">Unique Blocks for Family: {{ family_id }}</h1>
<p>Unique Blocks: {{ number_of_unique_blocks }}</p>

<h3>Filter</h3>

<form class="form-inline" action ="{{ url_for('data.result', job_id=job_info.job_id) }}" method='GET'>
    <div class="form-group row">
      <label class="col-3" for="block_count">Filter blocks to</label>
      <input class="col-3" type="text" name='min_score' id="min_score" aria-describedby="min_score" placeholder="min score (0-100)">
      <input class="col-3" type="text" name='min_block_length' id="min_block_length" aria-describedby="min_block_length" placeholder="min block length">
      <input class="col-3" type="text" name='max_block_length' id="max_block_length" aria-describedby="max_block_length" placeholder="max block length">
      <button type="submit" class="btn btn-primary">filter</button>
    </div>
</form>

<h3 id="unique-blocks">Unique Blocks</h3>
<p>total: {{ blkp.max_value }}, showing: {{ 1 + blkp.start_index }} - {{ blkp.end_index }}</p>
<table class="table table-hover">
    <thead class="thead-light">
      <tr>
        <th style="text-align: right;" scope="col">Score</th>
        <th scope="col">PicBlockHash</th>
        <th style="text-align: right;" scope="col">Samples</th>
        <th style="text-align: right;" scope="col">Instructions</th>
        <th style="text-align: right;" scope="col">Function ID</th>
        <th style="text-align: center;" scope="col">Block</th>
      </tr>
    </thead>
    <tbody>
      {% for block in results %}
      <tr>
        <td style="text-align: right;" valign="middle">{{ "%5.2f"|format(block["score"]) }}</td>
        <td valign="middle" scope="row" class="id">{{ block["key"] }}</td>
        <td style="text-align: right;" valign="middle">{{ block["samples"] }}</td>
        <td style="text-align: right;" valign="middle">{{ block["length"] }}</td>
        <td style="text-align: right;" valign="middle">{{ format_function_id(block["function_id"]) }}</td>
        <td style="text-align: left;" valign="middle"><code style="white-space:pre">{{ block["yarafied"] }}</code></td>
     </tr>
      {% endfor %}
    </tbody>
  </table>
  {{ pagination_widget(blkp, _anchor="unique-blocks")}}
{% endblock %}